---
title: Getting Started with Flatcar Container Linux 
linktitle: Installing
weight: 2
aliases:
    - os/quickstart
    - quickstart
---

This guide aims to get you up and running in a few minutes.
We'll cover
- concepts, configuration, and provisioning
- writing a basic Flatcar configuration and testing it locally with qemu
- further reading - pointers to docs for specific cloud providers

### Concepts, Configuration, and Provisioning

Flatcar Container Linux is configured at _provisioning time_.
There are two configuration languages to set up Flatcar, aimed at different use cases:
- [Container Linux Config][cl-config] (CLC) is human-readable / writable YAML and must be converted (transpiled) into Ignition config before Flatcar can use it.
- [Ignition config][ignition] is machine-readable JSON fed to Flatcar's ignition service.
  Ignition is Flatcars "installation sevice" which configures a Flatcar instance during provisioning.
  The config file is passed via the "custom data" or "user data" option of cloud providers, and can be supplied by various mechanisms to private cloud VMs and bare metal.
  Ignition config is rarely written by a human; it's usually generated by provisioning automation or transpiled from user-written CLC.

Use CLC to customise your Flatcar deployment, e.g. to
- add custom users and groups
- create and manage storage devices, file systems, and swap, and create custom files
- customise automatic updates and define reboot windows
- create custom network(d) configurations and systemd units
  - Want to e.g. run a custom operation or start a service each time the instance boots?
    Define a custom systemd unit via CLC.
All above tasks only take a few lines of YAML and are covered in our [CLC examples][cl-examples].
For a comprehensive discussion of all options available in CLC have a look at the [CLC specification][cl-spec].

To convert CLC into machine-readable Ignition config, just download the latest release of the [config transpiler](https://github.com/flatcar-linux/container-linux-config-transpiler/releases) for your platform.
Alternatively, use our up-to-date [container image](https://github.com/flatcar-linux/container-linux-config-transpiler/pkgs/container/ct): `docker run --rm -i ghcr.io/flatcar-linux/ct:latest`.

Then, after converting CLC to Ignition config, pass the Ignition config along when provisioning your instance(s).
The config is then passed via "user data" / "custom data" or similar means to the provisioning logic.

#### Writing your first config and testing it locally in a qemu VM

The way from a small [Container Linux Config (CLC) YAML][cl-configs] or [Ignition JSON][ignition] file to a local [QEMU VM][qemu-docs] on your laptop is not far.
Here we will create a systemd service that starts an NGINX container as example configuration for the VM.
This is a good starting point for you to modify the CLC YAML file (or the Ignition JSON file) and test it by provisioning a temporary QEMU VM.
This should work on most Linux systems and assumes you have an SSH key set up for ssh-agent.

First download the Flatcar QEMU image and the helper script to start it with QEMU.
```shell
wget https://stable.release.flatcar-linux.net/amd64-usr/current/flatcar_production_qemu_image.sh
chmod +x flatcar_production_qemu_image.sh
wget https://stable.release.flatcar-linux.net/amd64-usr/current/flatcar_production_qemu_image.img.bz2
bunzip2 flatcar_production_qemu_image.img.bz2
```

For testing Ignition configruations we have to make sure that we always boot an unmodified fresh image because Ignition only runs on first boot.
Therefore, before trying to use an Ignition config we will always discard the image modifications by using a fresh copy.
You can already boot the image and have a look around in the OS through the QEMU VGA console - you can close the QEMU window or stop the script with `Ctrl-C`.
```shell
mv flatcar_production_qemu_image.img flatcar_production_qemu_image.img.fresh
# If you want to have a first look, boot it and wait for the autologin to give you a prompt:
cp -i --reflink=auto flatcar_production_qemu_image.img.fresh flatcar_production_qemu_image.img
```

Besides the interaction with the VM through the VGA console you can also use SSH because the script passes your SSH public key to the VM.
Since we don't want to remember the VM's SSH host keys, we can add SSH options to ignore them.
The user is `core` and the script defauls to port 2222:
```shell
ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 2222 core@127.0.0.1
```

Now we will provision the VM on first boot through Ignition.
Instead of writing the JSON config we use CLC YAML and transpile it.
Save the following CLC YAML file as `cl.yaml` (or another name).
It contains directives for setting up a systemd service that runs an NGINX Docker container:

```yaml
systemd:
  units:
    - name: nginx.service
      enabled: true
      contents: |
        [Unit]
        Description=NGINX example
        After=docker.service
        Requires=docker.service
        [Service]
        TimeoutStartSec=0
        ExecStartPre=-/usr/bin/docker rm --force nginx1
        ExecStart=/usr/bin/docker run --name nginx1 --pull always --net host docker.io/nginx:1
        ExecStop=/usr/bin/docker stop nginx1
        Restart=always
        RestartSec=5s
        [Install]
        WantedBy=multi-user.target
```

Before we can use it we have to transpile the CLC YAML to Ignition JSON:

```shell
cat cl.yaml | docker run --rm -i ghcr.io/flatcar-linux/ct:latest > ignition.json
```

You can also skip this step and copy the resulting JSON file from here to `ignition.json` (or another name):

```
{
  "ignition": {
    "version": "2.3.0"
  },
  "systemd": {
    "units": [
      {
        "contents": "[Unit]\nDescription=NGINX example\nAfter=docker.service\nRequires=docker.service\n[Service]\nTimeoutStartSec=0\nExecStartPre=-/usr/bin/docker rm --force nginx1\nExecStart=/usr/bin/docker run --name nginx1 --pull always --net host docker.io/nginx:1\nExecStop=/usr/bin/docker stop busybox1\nRestart=always\nRestartSec=5s\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "nginx.service"
      }
    ]
  }
}
```

The final step is to boot the VM and make the Ignition configuration available to it.
As said, the provisioning will only be done on first boot and if you want your (changed) Ignition configuration to be used, you have to boot from a fresh copy.
You can repeat these combined steps as often as you want to test your Ignition changes:

```shell
# Make sure we boot a fresh copy:
cp -i --reflink=auto flatcar_production_qemu_image.img.fresh flatcar_production_qemu_image.img
./flatcar_production_qemu.sh -i ignition.json
# Log in via SSH in a new terminal tab:
ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -p 2222 core@127.0.0.1
# Check that NGINX is running:
systemctl status nginx
curl http://localhost/
```

You can reboot and stop the VM if you like - when you start it later with a plain `./flatcar_production_qemu.sh` then our systemd unit will take care of starting NGINX on each boot.
Note that the ignition config will only be processed on the very first boot - that's why we made a copy, so now we can restore our OS image from the pristine copy for successive experiments with CLC.

As listed in the introduction above there are numerous options available for configuring Flatcar just the way you need it. For instance, you can specify a custom SSH key instead of your default one from `~/.ssh/` in the CLC config, by adding this section to your YAML file:
```yaml
passwd:
  users:
    - name: core
      ssh_authorized_keys:
        - ssh-rsa AAAAB......xyz email@host.net
```

Afterwards, transpile it again to Ignition JSON, overwrite `flatcar_production_qemu_image.img` with the pristine image file, and pass the ignition config to `./flatcar_production_qemu.sh` once again.


### Further reading: Platform / vendor specific information

Check out the guides on [running Flatcar Container Linux][running-container-linux] on most cloud providers:
* [EC2][ec2-docs]
* [Azure][azure-docs]
* [GCE][gce-docs]
* [Equinix Metal][equinix-metal-docs]
virtualization platforms / private clouds:
* [Vagrant][vagrant-docs]
* [VMware][vmware-docs]
* [VirtualBox][virtualbox-docs]
* [QEMU/KVM][qemu-docs]/[libVirt][libvirt-docs]
and bare metal servers:
* [PXE][pxe-docs]
* [iPXE][ipxe-docs]
* [ISO][iso-docs]
* [Installer][install-docs]

With any of these guides you will have machines up and running in a few minutes.


[running-container-linux]: ../#installing-flatcar
[ec2-docs]: cloud/aws-ec2
[azure-docs]: cloud/azure
[gce-docs]: cloud/gcp
[vagrant-docs]: vms/vagrant
[vmware-docs]: cloud/vmware
[virtualbox-docs]: vms/virtualbox
[qemu-docs]: vms/qemu
[libvirt-docs]: vms/libvirt
[equinix-metal-docs]: cloud/equinix-metal
[pxe-docs]: bare-metal/booting-with-pxe
[ipxe-docs]: bare-metal/booting-with-ipxe
[iso-docs]: bare-metal/booting-with-iso
[install-docs]: bare-metal/installing-to-disk
[ignition]: ../provisioning/ignition/
[cl-configs]: ../provisioning/cl-config
[cl-examples]: ../provisioning/cl-config/examples
[cl-spec]: ../provisioning/config-transpiler/configuration
